# 【周易通V1.0】-【每日一卦】-每日卦象测试用例

## 文档信息

| 项目 | 内容 |
|------|------|
| 模块名称 | 每日一卦 - 每日卦象 |
| 文档版本 | v1.0 |
| 编写日期 | 2026-01-14 |
| 文档状态 | 待评审 |

---

## 每日一卦功能

### 每日卦象推送

#### 接收每日推送-成功接收 ZYT-DAILY-001

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 用户已授权推送通知
2. 用户已登录
3. 推送时间已到（每天早上8点）

**测试步骤**：
1. 等待早上8点推送时间
2. 查看手机通知栏
3. 点击推送通知

**预期结果**：
1. 收到推送通知
2. 通知标题："今日卦象"
3. 通知内容：卦象名称+简短描述
4. 点击通知后打开APP
5. 直接进入当日卦象解释页面
6. 卦象信息完整展示

**备注**：
- 每天早上8点推送
- 需用户授权推送权限
- 关联需求：PRD-3.5.1

---

#### 接收每日推送-未授权通知 ZYT-DAILY-002

**优先级**：中
**测试类型**：异常

**前置条件**：
1. 用户未授权推送通知
2. 推送时间已到

**测试步骤**：
1. 推送时间已到
2. 查看手机通知栏

**预期结果**：
1. 不会收到推送通知
2. 打开APP后可在"每日一卦"页面查看当日卦象
3. 提示"您未开启推送通知，开启后可每日接收"

**备注**：
- 未授权不推送
- 可在APP内查看

---

### 查看当日卦象

#### 查看当日卦象-免费用户 ZYT-DAILY-003

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 用户已登录（免费用户）
2. 当天已推送卦象

**测试步骤**：
1. 点击底部导航栏"每日一卦"Tab
2. 查看当日卦象页面

**预期结果**：
1. 显示当日卦象符号（如"䷀"）
2. 显示当日卦象名称（如"乾为天"）
3. 显示卦辞原文
4. 显示卦辞白话解释
5. 显示推送日期
6. 显示分享按钮
7. 提示"会员可查看历史卦象"

**备注**：
- 当日卦象所有用户可见
- 免费用户只能看当天
- 关联需求：PRD-3.5.2

---

#### 查看当日卦象-会员 ZYT-DAILY-004

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 会员用户
2. 当天已推送卦象

**测试步骤**：
1. 进入"每日一卦"页面
2. 查看当日卦象

**预期结果**：
1. 当日卦象正常显示
2. 提供"查看历史卦象"按钮
3. 可查看历史每日一卦记录

**备注**：
- 会员可查看历史
- 会员权益

---

#### 查看当日卦象-游客 ZYT-DAILY-005

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 游客模式

**测试步骤**：
1. 点击底部导航栏"每日一卦"Tab
2. 查看当日卦象

**预期结果**：
1. 可正常查看当日卦象
2. 卦象信息完整
3. 但无法查看历史
4. 提示"登录后保存历史记录"

**备注**：
- 游客可看当天
- 无历史记录

---

### 历史卦象查看

#### 查看历史卦象-会员用户 ZYT-DAILY-006

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 会员用户
2. 有历史卦象记录

**测试步骤**：
1. 进入"每日一卦"页面
2. 点击"查看历史"或"历史卦象"按钮
3. 查看历史列表

**预期结果**：
1. 显示历史卦象列表
2. 按时间倒序排列
3. 每条记录显示：
   - 日期
   - 卦象符号
   - 卦象名称
   - 简短描述
4. 可点击查看详情
5. 支持分页加载
6. 显示记录总数

**备注**：
- 会员专享功能
- 历史记录永久保存
- 关联需求：PRD-3.5.2

---

#### 查看历史卦象-免费用户限制 ZYT-DAILY-007

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 免费用户

**测试步骤**：
1. 进入"每日一卦"页面
2. 点击"查看历史"按钮

**预期结果**：
1. 弹出付费引导弹窗
2. 提示"查看历史卦象为会员专享功能"
3. 说明会员权益
4. 提供"立即开通"按钮
5. 点击后跳转至会员购买页面
6. 无法查看历史

**备注**：
- 免费用户无法查看历史
- 引导购买会员

---

#### 历史卦象详情-查看完整内容 ZYT-DAILY-008

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 会员用户
2. 有历史卦象记录

**测试步骤**：
1. 在历史列表中
2. 点击某条历史记录
3. 查看详情

**预期结果**：
1. 显示该卦象完整内容
2. 包括卦名、卦符、卦辞
3. 包括白话解释
4. 显示推送日期
5. 内容与当日推送一致

**备注**：
- 历史记录完整保存
- 支持回看

---

### 分享功能

#### 分享卦象-分享至微信 ZYT-DAILY-009

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 在每日一卦页面
2. 已安装微信

**测试步骤**：
1. 点击"分享"按钮
2. 选择"分享至微信好友"或"分享至朋友圈"
3. 完成分享

**预期结果**：
1. 调用微信分享功能
2. 显示分享预览
3. 分享内容包括：
   - 卦象符号
   - 卦象名称
   - 卦辞简短版
   - APP推广链接
4. 分享成功提示

**备注**：
- 支持微信好友和朋友圈
- 带推广链接
- 关联需求：PRD-3.8.1

---

#### 分享卦象-保存图片 ZYT-DAILY-010

**优先级**：低
**测试类型**：功能

**前置条件**：
1. 在每日一卦页面

**测试步骤**：
1. 点击"分享"按钮
2. 选择"保存为图片"
3. 查看相册

**预期结果**：
1. 生成卦象分享图片
2. 图片包含卦象符号和名称
3. 保存至手机相册
4. 可手动分享

**备注**：
- 生成分享图
- 低优先级功能

---

### 推送设置

#### 设置推送时间-成功修改 ZYT-DAILY-011

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 用户已登录

**测试步骤**：
1. 进入个人中心
2. 进入"设置"页面
3. 找到"每日一卦推送时间"
4. 修改推送时间（如改为9:00）

**预期结果**：
1. 修改成功
2. 提示"设置已保存"
3. 从次日起在新的时间点推送
4. 数据库中推送时间已更新

**备注**：
- 可自定义推送时间
- 24小时制

---

#### 关闭推送-不再接收 ZYT-DAILY-012

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 用户已开启推送

**测试步骤**：
1. 进入设置页面
2. 找到"每日一卦推送"开关
3. 关闭推送

**预期结果**：
1. 推送开关变为"关"
2. 提示"已关闭推送"
3. 从次日起不再收到推送
4. 数据库中设置已更新
5. 可重新开启

**备注**：
- 用户可关闭推送
- 随时可重新开启

---

## 附录

### 测试数据

| 数据类型 | 示例值 | 用途 |
|---------|--------|------|
| 每日卦象 | 乾为天（䷀） | 推送测试 |
| 推送时间 | 08:00 | 推送时间 |
| 自定义时间 | 09:00 | 自定义时间测试 |

### 每日卦象数据结构

```typescript
{
  date: "2026-01-14",
  hexagram: {
    name: "乾为天",
    symbol: "䷀",
    sequence: 1
  },
  guaci: "乾，元，亨，利，贞。",
  translation: "乾卦象征天..."
}
```

### 测试环境要求

| 环境项 | 要求 |
|--------|------|
| 推送服务 | 个推/极光推送/厂商推送 |
| 推送权限 | 用户已授权 |
| 网络 | 正常网络 |

### 相关文档

- PRD文档：`.taskmaster/docs/prd.md`
- 测试用例组织规则：`docs/test-rule/00-【周易通V1.0】测试用例组织规则.md`
- 每日卦象Schema：`src/database/schemas/daily-hexagram.schema.ts`

---

## 更新记录

| 版本 | 日期 | 更新内容 | 更新人 |
|------|------|----------|--------|
| v1.0 | 2026-01-14 | 初始版本，完成12条测试用例设计 | Claude |
