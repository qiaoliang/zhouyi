# 【周易通V1.0】-【会员支付】-会员购买测试用例

## 文档信息

| 项目 | 内容 |
|------|------|
| 模块名称 | 会员支付 - 会员购买 |
| 文档版本 | v1.0 |
| 编写日期 | 2026-01-14 |
| 文档状态 | 待评审 |

---

## 会员购买功能

### 查看会员套餐

#### 查看会员套餐页面-套餐展示 ZYT-PAY-001

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 用户已登录或游客
2. 网络连接正常

**测试步骤**：
1. 点击首页"开通会员"或"会员中心"入口
2. 进入会员购买页面

**预期结果**：
1. 显示会员套餐列表：
   - 月卡：30元/月
   - 季卡：80元/季（省10元）
   - 年卡：300元/年（省60元）
2. 每个套餐显示：
   - 价格
   - 节省金额
   - 保存百分比
3. 显示会员权益列表
4. 突出推荐套餐（年卡）
5. 显示"立即开通"按钮

**备注**：
- 三种套餐可选
- 年卡性价比最高
- 关联需求：PRD-3.7.2

---

#### 查看会员权益-权益列表展示 ZYT-PAY-002

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 在会员购买页面

**测试步骤**：
1. 滚动查看会员权益

**预期结果**：
1. 显示详细权益列表：
   - 详细解卦（变卦、互卦、应期分析）
   - 精准解卦（生辰八字个性化）
   - 收藏功能
   - 无卜卦次数限制
   - 无广告体验
   - 专属客服
   - 每日一卦历史
   - 历史记录管理
2. 权益描述清晰
3. 使用图标或列表展示

**备注**：
- 清晰展示会员价值
- 引导用户购买

---

### 选择套餐

#### 选择套餐-月卡 ZYT-PAY-003

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 在会员购买页面

**测试步骤**：
1. 点击选择"月卡"套餐
2. 查看"立即开通"按钮

**预期结果**：
1. 月卡卡片高亮或选中
2. 价格显示：30元/月
3. 显示"立即开通 - ¥30"按钮
4. 点击后进入支付流程

**备注**：
- 月卡适合试用

---

#### 选择套餐-年卡推荐 ZYT-PAY-004

**优先级**：中
**测试类型**：UI

**前置条件**：
1. 在会员购买页面

**测试步骤**：
1. 查看套餐展示

**预期结果**：
1. 年卡显示"推荐"标签
2. 年卡卡片更突出
3. 显示"最划算"标识
4. 显示节省60元
5. 节省百分比醒目

**备注**：
- 推荐年卡
- 提高客单价

---

### 模拟支付

#### 模拟支付-成功支付 ZYT-PAY-005

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 测试环境
2. 已选择套餐

**测试步骤**：
1. 点击"立即开通"
2. 选择支付方式（微信支付/支付宝）
3. 进入模拟支付流程
4. 等待支付结果

**预期结果**：
1. 显示支付中状态
2. 2-3秒后模拟支付成功
3. 显示"支付成功"提示
4. 自动跳转至会员中心
5. 会员状态更新为"会员"
6. 显示会员到期时间
7. 所有会员权益生效

**备注**：
- 测试环境使用模拟支付
- 生产环境接入真实支付
- 关联需求：PRD-3.7

---

#### 模拟支付-支付失败 ZYT-PAY-006

**优先级**：中
**测试类型**：异常

**前置条件**：
1. 测试环境
2. 已选择套餐

**测试步骤**：
1. 点击"立即开通"
2. 选择模拟支付失败场景

**预期结果**：
1. 显示支付中状态
2. 模拟支付失败
3. 显示"支付失败"提示
4. 说明失败原因
5. 提供"重新支付"按钮
6. 可重新发起支付

**备注**：
- 模拟失败场景
- 异常处理

---

#### 模拟支付-取消支付 ZYT-PAY-007

**优先级**：中
**测试类型**：异常

**前置条件**：
1. 进入支付流程

**测试步骤**：
1. 在支付页面
2. 点击"取消"或返回

**预期结果**：
1. 支付流程取消
2. 返回会员购买页面
3. 订单状态为"已取消"
4. 可重新发起支付

**备注**：
- 支持取消支付
- 记录取消状态

---

### 订单管理

#### 订单查询-查看订单列表 ZYT-PAY-008

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 用户已登录
2. 有历史订单

**测试步骤**：
1. 进入会员中心
2. 点击"我的订单"
3. 查看订单列表

**预期结果**：
1. 显示所有会员订单
2. 每条订单显示：
   - 订单号
   - 套餐类型（月卡/季卡/年卡）
   - 订单金额
   - 订单状态（已支付/待支付/已取消）
   - 下单时间
3. 按时间倒序排列
4. 支持分页

**备注**：
- 订单记录查询
- 支持历史查看

---

#### 订单详情-查看详细信息 ZYT-PAY-009

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 有订单记录

**测试步骤**：
1. 在订单列表中
2. 点击某条订单
3. 查看详情

**预期结果**：
1. 显示完整订单信息：
   - 订单号
   - 套餐详情
   - 订单金额
   - 支付方式
   - 订单状态
   - 下单时间
   - 支付时间（如已支付）
2. 已支付订单显示会员信息
3. 未支付订单提供"继续支付"按钮

**备注**：
- 订单详情完整展示

---

### 会员权益生效

#### 会员权益-详细解卦解锁 ZYT-PAY-010

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 用户已购买会员
2. 会员未过期

**测试步骤**：
1. 完成一次起卦
2. 点击"查看详细解卦"

**预期结果**：
1. 直接显示详细解卦内容
2. 无付费引导弹窗
3. 显示会员标识
4. 所有详细解卦功能可用

**备注**：
- 会员核心权益
- 详细解卦免费

---

#### 会员权益-精准解卦解锁 ZYT-PAY-011

**优先级**：高
**测试类型**：功能

**前置条件**：
1. 用户已购买会员

**测试步骤**：
1. 完成起卦
2. 填写精准信息
3. 查看精准解卦

**预期结果**：
1. 可填写精准信息表单
2. 可查看精准解卦结果
3. 无付费引导
4. 功能完全可用

**备注**：
- 精准解卦会员专享

---

#### 会员权益-历史记录解锁 ZYT-PAY-012

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 用户已购买会员

**测试步骤**：
1. 进入历史记录页面
2. 点击"查看历史"

**预期结果**：
1. 可查看所有历史记录
2. 无数量限制
3. 支持收藏和删除

**备注**：
- 历史记录管理权益

---

### 会员续费

#### 会员续费-到期前续费 ZYT-PAY-013

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 会员即将到期（7天内）

**测试步骤**：
1. 进入会员中心
2. 查看会员状态
3. 点击"续费"按钮

**预期结果**：
1. 显示会员到期时间
2. 提示"您的会员即将到期"
3. 提供"立即续费"按钮
4. 续费后到期时间延长

**备注**：
- 到期前提醒续费
- 保持会员连续性

---

#### 会员过期-重新开通 ZYT-PAY-014

**优先级**：中
**测试类型**：功能

**前置条件**：
1. 会员已过期

**测试步骤**：
1. 进入会员中心
2. 查看会员状态
3. 点击"重新开通"

**预期结果**：
1. 显示"会员已过期"
2. 显示过期时间
3. 提供"立即开通"按钮
4. 开通后会员重新生效

**备注**：
- 过期会员重新购买

---

## 附录

### 测试数据

| 数据类型 | 示例值 | 用途 |
|---------|--------|------|
| 月卡价格 | 30元/月 | 价格测试 |
| 季卡价格 | 80元/季 | 价格测试 |
| 年卡价格 | 300元/年 | 价格测试 |
| 订单状态 | 已支付/待支付 | 状态测试 |

### 会员套餐对比

| 套餐 | 价格 | 节省 | 性价比 |
|------|------|------|--------|
| 月卡 | 30元 | - | 基准 |
| 季卡 | 80元 | 10元 | 11% OFF |
| 年卡 | 300元 | 60元 | 17% OFF |

### 订单数据结构

```typescript
{
  orderId: "order_001",
  userId: "user_001",
  type: "yearly",           // yearly/monthly/quarterly
  amount: 30000,            // 单位：分
  status: "paid",           // paid/unpaid/cancelled
  paymentMethod: "wechat",
  transactionId: "wx_001",
  createdAt: "2026-01-14",
  paidAt: "2026-01-14"
}
```

### 测试环境要求

| 环境项 | 要求 |
|--------|------|
| 支付环境 | 测试环境使用模拟支付 |
| 网络 | 正常网络 |
| 用户 | 登录用户 |

### 相关文档

- PRD文档：`.taskmaster/docs/prd.md`
- 测试用例组织规则：`docs/test-rule/00-【周易通V1.0】测试用例组织规则.md`
- 会员控制器：`src/modules/membership/membership.controller.ts`

---

## 更新记录

| 版本 | 日期 | 更新内容 | 更新人 |
|------|------|----------|--------|
| v1.0 | 2026-01-14 | 初始版本，完成14条测试用例设计 | Claude |
