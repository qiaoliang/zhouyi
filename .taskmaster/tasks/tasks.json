{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "项目架构搭建",
        "description": "搭建周易通APP的基础技术架构,包括前端框架选择、后端服务搭建、数据库设计等",
        "status": "done",
        "priority": "critical",
        "tags": [
          "architecture",
          "setup"
        ],
        "details": "根据PRD要求,需要支持iOS/Android APP、微信小程序和H5网页版。需要选择合适的前端技术栈(如React Native/Flutter)和后端技术栈(Node.js),以及数据库选择(MongoDB或PostgreSQL)",
        "acceptanceCriteria": [
          "完成前端技术栈选型和环境搭建",
          "完成后端服务基础框架",
          "完成数据库设计和初始化",
          "完成第三方服务接入准备(微信登录、短信、支付、推送)"
        ],
        "testStrategy": "验证各平台环境可以正常启动和运行基础功能",
        "subtasks": [
          {
            "id": 1,
            "title": "前端技术栈调研和选型",
            "description": "调研并确定iOS/Android APP、微信小程序和H5的技术栈方案",
            "status": "completed",
            "priority": "critical",
            "details": "需要评估:\n1. React Native vs Flutter(移动端)\n2. 微信小程序原生框架 vs uni-app vs taro\n3. React.js vs Vue.js(H5)\n4. 考虑团队技术栈、开发效率、性能、生态成熟度\n5. 代码复用可能性分析",
            "acceptanceCriteria": [
              "完成技术栈对比分析文档",
              "确定各平台技术栈选型",
              "评估开发成本和时间",
              "确定代码复用策略"
            ],
            "testStrategy": "通过POC验证关键技术的可行性",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "前端开发环境搭建",
            "description": "搭建移动端、小程序和H5的开发环境和项目脚手架",
            "status": "completed",
            "priority": "critical",
            "details": "需要完成:\n1. iOS开发环境(Xcode、CocoaPods等)\n2. Android开发环境(Android Studio、SDK等)\n3. 微信开发者工具\n4. Node.js和包管理器(npm/yarn/pnpm)\n5. 代码编辑器配置(VS Code插件等)\n6. 项目初始化和脚手架搭建\n7. TypeScript配置\n8. 代码规范配置(ESLint、Prettier)",
            "acceptanceCriteria": [
              "各平台开发环境配置完成",
              "项目脚手架可以正常运行",
              "可以在模拟器/真机上运行Hello World",
              "代码规范工具正常工作"
            ],
            "testStrategy": "在各平台环境成功运行基础项目",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "后端技术栈选型和架构设计",
            "description": "设计后端服务架构,确定技术栈和部署方案",
            "status": "completed",
            "priority": "critical",
            "details": "需要设计:\n1. 后端框架选择(Express.js/Nest.js/Koa.js)\n2. 数据库选型(MongoDB/PostgreSQL)\n3. 缓存方案(Redis)\n4. 文件存储(云服务OSS)\n5. API设计规范(RESTful/GraphQL)\n6. 认证授权方案(JWT/Session)\n7. 微服务架构设计(如需要)\n8. 部署方案(云服务商选择)",
            "acceptanceCriteria": [
              "完成后端架构设计文档",
              "确定技术栈选型",
              "完成API接口设计草案",
              "确定部署和运维方案"
            ],
            "testStrategy": "通过技术评审验证架构设计",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "后端服务框架搭建",
            "description": "搭建后端服务基础框架,包括项目结构、中间件配置等",
            "status": "completed",
            "priority": "critical",
            "details": "需要完成:\n1. Node.js项目初始化\n2. Express/Nest.js框架配置\n3. 项目目录结构规划\n4. 中间件配置(日志、错误处理、CORS等)\n5. 路由设计\n6. 数据库连接配置\n7. Redis连接配置\n8. 环境变量管理\n9. 日志系统\n10. 基础API示例(Health Check等)",
            "acceptanceCriteria": [
              "后端服务可以正常启动",
              "基础API可以正常访问",
              "数据库连接正常",
              "日志系统正常工作",
              "代码结构清晰规范"
            ],
            "testStrategy": "测试后端服务启动和基础API响应",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "数据库设计和初始化",
            "description": "设计数据库表结构,创建索引,初始化数据",
            "status": "completed",
            "priority": "critical",
            "details": "需要完成:\n1. 用户表设计(用户基本信息、会员信息等)\n2. 卜卦记录表设计\n3. 学习进度表设计\n4. 六十四卦数据表设计\n5. 每日一卦数据表设计\n6. 订单表设计\n7. 索引设计优化\n8. 数据库迁移方案\n9. 种子数据准备(六十四卦基础数据)\n10. 数据库备份策略",
            "acceptanceCriteria": [
              "完成数据库ER图设计",
              "完成所有表结构创建",
              "索引设计合理",
              "种子数据导入成功",
              "备份策略确定"
            ],
            "testStrategy": "验证数据库设计和查询性能",
            "parentId": "undefined"
          },
          {
            "id": 6,
            "title": "第三方服务账号申请和配置",
            "description": "申请各类第三方服务账号,完成基础配置",
            "status": "completed",
            "priority": "critical",
            "details": "需要申请:\n1. 微信开放平台账号(移动应用登录)\n2. 微信小程序账号\n3. 微信商户号(支付)\n4. 支付宝商户号\n5. 短信服务商账号(阿里云/腾讯云)\n6. 推送服务账号(极光/个推)\n7. 云服务账号(阿里云/腾讯云)\n8. 域名和SSL证书",
            "acceptanceCriteria": [
              "所有第三方账号申请完成",
              "完成开发环境配置",
              "完成沙箱环境配置",
              "API密钥安全存储"
            ],
            "testStrategy": "验证各第三方服务的基本连通性",
            "parentId": "undefined"
          },
          {
            "id": 7,
            "title": "CI/CD流水线搭建",
            "description": "搭建持续集成和持续部署流水线",
            "status": "completed",
            "priority": "high",
            "details": "需要完成:\n1. 代码仓库配置(GitLab/GitHub/Gitee)\n2. CI/CD工具选择(GitLab CI/GitHub Actions/Jenkins)\n3. 自动化测试流程\n4. 自动化构建流程\n5. 自动化部署流程\n6. 环境管理(开发/测试/生产)\n7. 代码质量检查\n8. 自动化通知机制",
            "acceptanceCriteria": [
              "代码提交自动触发构建",
              "自动化测试通过",
              "可以自动部署到测试环境",
              "构建失败有通知"
            ],
            "testStrategy": "测试完整的CI/CD流程",
            "parentId": "undefined"
          },
          {
            "id": 8,
            "title": "开发规范和代码规范制定",
            "description": "制定项目开发规范、代码规范和文档规范",
            "status": "completed",
            "priority": "high",
            "details": "需要制定:\n1. 代码命名规范\n2. 代码注释规范\n3. Git提交规范(Conventional Commits)\n4. 代码审查规范\n5. API设计规范\n6. 数据库设计规范\n7. 错误处理规范\n8. 安全开发规范\n9. 文档编写规范\n10. 开发流程规范",
            "acceptanceCriteria": [
              "完成开发规范文档",
              "团队Review并确认",
              "配置自动化检查工具"
            ],
            "testStrategy": "团队评审确认规范可行性",
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2026-01-11T23:27:46.778Z",
        "dependencies": []
      },
      {
        "id": 2,
        "title": "用户系统开发",
        "description": "实现用户注册登录功能,包括微信授权登录、手机验证码登录、游客模式",
        "status": "done",
        "priority": "critical",
        "tags": [
          "user",
          "auth"
        ],
        "details": "需要实现:\n1. 微信授权登录(APP和小程序)\n2. 手机号+验证码登录\n3. 游客模式(先体验后注册)\n4. 游客模式限制(历史记录不保存、仅可卜卦2次、不可用付费功能)\n5. 游客卜卦2次后引导注册\n6. 个人中心页面",
        "acceptanceCriteria": [
          "微信授权登录功能正常",
          "手机验证码登录功能正常",
          "游客模式可以正常体验",
          "游客限制正确实施",
          "引导注册弹窗正确触发",
          "个人中心页面功能完整"
        ],
        "testStrategy": "测试各种登录方式的完整流程,验证游客模式限制和引导注册逻辑",
        "subtasks": [
          {
            "id": 1,
            "title": "用户认证后端API开发",
            "description": "开发用户认证相关的后端接口，包括用户表设计、JWT token生成、微信登录接口、手机号登录接口",
            "dependencies": [],
            "details": "设计用户数据表结构，实现用户注册、登录、token刷新等API接口，集成微信开放平台SDK，实现短信验证码服务对接",
            "status": "done",
            "testStrategy": "使用Postman测试所有API接口，验证token生成和验证逻辑",
            "parentId": "undefined",
            "updatedAt": "2026-01-12T22:51:20.974Z"
          },
          {
            "id": 2,
            "title": "微信授权登录前端实现",
            "description": "实现APP和小程序端的微信授权登录功能，包括授权页面、回调处理、登录状态管理",
            "dependencies": [
              1
            ],
            "details": "集成微信SDK，实现APP端微信登录和小程序端wx.login，处理授权回调，存储用户token，实现登录状态持久化",
            "status": "done",
            "testStrategy": "在真机上测试APP和小程序的微信授权登录流程",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:23:44.120Z"
          },
          {
            "id": 3,
            "title": "手机验证码登录实现",
            "description": "实现手机号+验证码登录功能，包括验证码发送、倒计时、登录验证",
            "dependencies": [
              1
            ],
            "details": "实现手机号输入页面、验证码发送按钮（带60秒倒计时）、验证码输入框、登录按钮，对接后端验证码发送和验证接口",
            "status": "done",
            "testStrategy": "测试验证码发送、倒计时功能、验证码正确性和错误处理",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T05:44:25.228Z"
          },
          {
            "id": 4,
            "title": "游客模式及限制逻辑实现",
            "description": "实现游客模式功能，包括游客身份标识、卜卦次数限制、历史记录不保存、付费功能禁用、引导注册弹窗",
            "dependencies": [
              1
            ],
            "details": "实现游客模式登录入口，本地存储游客卜卦次数，在卜卦功能中添加游客限制判断，实现2次后弹出引导注册弹窗，禁用游客的付费功能入口",
            "status": "done",
            "testStrategy": "测试游客模式卜卦次数限制、历史记录不保存、引导注册弹窗触发时机",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:23:45.347Z"
          },
          {
            "id": 5,
            "title": "个人中心页面开发",
            "description": "开发个人中心页面，展示用户信息、登录状态、功能入口等",
            "dependencies": [
              2,
              3,
              4
            ],
            "details": "实现个人中心页面UI，展示用户头像、昵称、登录状态（游客/已登录），提供登录/注册入口、设置入口、退出登录等功能",
            "status": "done",
            "testStrategy": "测试个人中心页面在不同登录状态下的显示效果，验证各功能入口跳转正确",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T05:44:25.232Z"
          },
          {
            "id": 6,
            "title": "实现微信授权登录功能（APP和小程序）",
            "description": "实现APP和小程序端的微信授权登录功能。注意：手机验证码登录已在任务2.15中完成。",
            "dependencies": [],
            "details": "1. 集成微信SDK，实现APP端微信授权登录流程；2. 实现小程序端微信授权登录（使用wx.login获取code）；3. 后端实现微信登录接口，调用微信接口获取openid和session_key；4. 统一登录状态管理，复用任务2.15的JWT认证系统；5. 处理微信授权失败、用户取消授权等异常情况；6. 实现微信用户信息绑定和更新逻辑\n<info added on 2026-01-13T00:09:19.505Z>\n后端部分已完成。具体包括：\n1. 后端API实现：WechatService（小程序/APP登录）、AuthService（业务逻辑）、AuthController（端点）均已实现。\n2. 测试覆盖：47个自动化测试全部通过（WechatService 11个、AuthService 21个、AuthController 15个）。\n3. API文档：已创建详细文档（docs/backend/微信登录API文档.md）。\n待前端完成：APP端微信SDK集成、小程序端微信登录实现。\n</info added on 2026-01-13T00:09:19.505Z>",
            "status": "done",
            "testStrategy": "测试APP和小程序微信授权登录完整流程，验证新用户注册和老用户登录逻辑，测试授权取消和失败场景",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:11:03.933Z"
          },
          {
            "id": 7,
            "title": "实现游客模式及其使用限制逻辑",
            "description": "开发游客模式功能，包括游客身份识别、使用限制和引导注册机制",
            "dependencies": [
              6
            ],
            "details": "1. 实现游客模式入口和游客身份标识生成；2. 开发游客卜卦次数计数器（限制2次）；3. 实现游客历史记录不保存逻辑；4. 禁用游客访问付费功能；5. 开发游客卜卦2次后的注册引导弹窗；6. 实现游客转正式用户的数据迁移逻辑",
            "status": "done",
            "testStrategy": "验证游客模式可以正常进入，测试卜卦次数限制、历史记录不保存、付费功能禁用等限制，确认2次后正确弹出注册引导",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:23:46.593Z"
          },
          {
            "id": 8,
            "title": "开发个人中心页面及用户信息管理",
            "description": "实现个人中心页面UI和功能，包括用户信息展示、登录状态切换和退出登录",
            "dependencies": [
              6,
              7
            ],
            "details": "1. 设计并实现个人中心页面UI布局；2. 展示用户头像、昵称、手机号等基本信息；3. 实现游客用户和正式用户的不同展示状态；4. 开发游客转正式用户的注册入口；5. 实现退出登录功能，清除本地缓存；6. 添加用户协议和隐私政策入口",
            "status": "done",
            "testStrategy": "测试个人中心页面UI展示，验证游客和正式用户状态切换，测试退出登录功能是否正确清除用户数据",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:23:47.816Z"
          },
          {
            "id": 9,
            "title": "用户数据库模型设计",
            "description": "设计用户系统相关的数据库表结构，包括用户表、游客表、登录记录表等",
            "dependencies": [],
            "details": "设计用户表字段：用户ID、微信openid、手机号、昵称、头像、用户类型(正式/游客)、创建时间、更新时间等。设计游客表字段：游客ID、设备标识、卜卦次数、创建时间等。设计登录记录表：记录ID、用户ID、登录方式、登录时间、设备信息等。考虑索引优化和数据完整性约束",
            "status": "done",
            "testStrategy": "验证数据库表结构设计合理性，测试索引性能，确保字段类型和约束符合业务需求",
            "parentId": "undefined",
            "updatedAt": "2026-01-12T14:55:51.772Z"
          },
          {
            "id": 10,
            "title": "微信授权登录功能实现",
            "description": "实现APP和小程序端的微信授权登录功能，包括前端授权和后端接口对接",
            "dependencies": [
              9
            ],
            "details": "APP端集成微信SDK，实现微信授权登录流程。小程序端使用wx.login获取code，后端调用微信接口换取openid和session_key。后端实现微信登录接口，处理用户信息获取、用户创建/更新、token生成和返回。处理微信授权失败、用户取消授权等异常情况",
            "status": "done",
            "testStrategy": "测试APP和小程序端微信授权登录完整流程，验证新用户注册和老用户登录逻辑，测试各种异常场景",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:25:22.408Z"
          },
          {
            "id": 11,
            "title": "手机验证码登录功能实现",
            "description": "实现手机号+验证码登录功能，包括验证码发送、验证和登录流程",
            "dependencies": [
              9
            ],
            "details": "集成短信服务（如阿里云短信），实现验证码发送接口，包含手机号格式校验、发送频率限制、验证码有效期控制。实现验证码验证接口，校验验证码正确性和时效性。实现手机号登录接口，处理用户创建/更新、token生成。考虑验证码缓存策略和防刷机制",
            "status": "done",
            "testStrategy": "测试验证码发送功能（包括频率限制），测试验证码正确性和过期逻辑，测试手机号登录完整流程，验证新用户注册和老用户登录",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:25:23.537Z"
          },
          {
            "id": 12,
            "title": "游客模式及限制逻辑实现",
            "description": "实现游客模式入口、游客限制功能和游客转注册引导逻辑",
            "dependencies": [
              9
            ],
            "details": "实现游客模式入口，生成唯一游客标识并存储到本地。实现游客限制逻辑：历史记录不保存到服务器、仅可卜卦2次（本地计数）、不可用付费功能。实现卜卦次数检查和引导注册弹窗，当游客卜卦2次后弹出注册引导。实现游客转正式用户的数据迁移逻辑",
            "status": "done",
            "testStrategy": "测试游客模式入口和标识生成，验证卜卦次数限制和历史记录不保存逻辑，测试引导注册弹窗触发时机，验证游客转注册后的数据迁移",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:25:24.673Z"
          },
          {
            "id": 13,
            "title": "个人中心页面开发",
            "description": "开发个人中心页面，展示用户信息、登录状态管理和相关功能入口",
            "dependencies": [
              10,
              11,
              12
            ],
            "details": "设计个人中心页面UI布局，包括用户头像、昵称、登录状态显示。实现登录/注册入口按钮，游客用户显示引导注册。实现正式用户的个人信息展示和编辑功能。实现退出登录功能，清除本地token和用户信息。实现跳转到设置、关于等页面的入口",
            "status": "done",
            "testStrategy": "测试个人中心页面UI展示，验证游客和正式用户的不同显示状态，测试登录/注册跳转，测试退出登录功能，测试个人信息编辑功能",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:25:25.822Z"
          },
          {
            "id": 14,
            "title": "微信授权登录功能实现",
            "description": "实现APP和小程序端的微信授权登录功能，包括授权流程和用户信息获取",
            "dependencies": [],
            "details": "集成微信开放平台SDK，实现微信授权登录接口。APP端使用微信SDK获取授权码，小程序端使用wx.login获取code。后端接收code后调用微信接口获取用户openid和session_key，生成JWT token返回给前端。处理授权失败和取消授权的异常情况。",
            "status": "done",
            "testStrategy": "测试APP和小程序端的微信授权登录完整流程，验证授权成功后能正确获取用户信息并生成token，测试取消授权和授权失败场景",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:14:53.337Z"
          },
          {
            "id": 15,
            "title": "手机号验证码登录功能实现",
            "description": "实现手机号输入、验证码发送和验证码登录的完整流程",
            "dependencies": [],
            "details": "开发手机号输入界面，集成短信验证码服务（如阿里云短信）。实现验证码发送接口，包含手机号格式验证、发送频率限制（60秒一次）。实现验证码验证接口，验证码有效期5分钟。验证成功后生成JWT token返回。记录验证码发送日志用于安全审计。",
            "status": "done",
            "testStrategy": "测试手机号格式验证、验证码发送频率限制、验证码有效期、验证码错误提示等场景，确保登录流程安全可靠",
            "parentId": "undefined",
            "updatedAt": "2026-01-12T15:21:19.689Z"
          },
          {
            "id": 16,
            "title": "游客模式基础功能开发",
            "description": "实现游客模式登录和基础体验功能，支持用户先体验后注册",
            "dependencies": [],
            "details": "实现游客模式登录入口，生成临时游客标识（guest_id），存储在本地。游客模式下允许用户使用基础功能，包括浏览内容、起卦等。游客数据仅存储在本地，不上传服务器。实现游客身份识别和状态管理，确保游客体验流畅。",
            "status": "done",
            "testStrategy": "测试游客模式登录、基础功能使用、游客数据本地存储等功能，验证游客身份正确识别",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:24:46.548Z"
          },
          {
            "id": 17,
            "title": "游客模式限制和引导注册实现",
            "description": "实现游客模式的功能限制和卜卦2次后引导注册的逻辑",
            "dependencies": [
              16
            ],
            "details": "实现游客卜卦次数统计，使用本地存储记录卜卦次数。游客模式下历史记录不保存到服务器。限制游客不可使用付费功能，点击付费功能时弹出引导注册提示。当游客卜卦达到2次时，弹出注册引导弹窗，提供微信登录和手机号登录入口。实现游客转正式用户的数据迁移逻辑。",
            "status": "done",
            "testStrategy": "测试游客卜卦次数统计、历史记录不保存、付费功能限制、2次后引导注册弹窗等功能，验证所有限制逻辑正确执行",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T05:44:16.821Z"
          },
          {
            "id": 18,
            "title": "个人中心页面开发",
            "description": "开发个人中心页面，展示用户信息和提供账户管理功能",
            "dependencies": [
              14,
              15
            ],
            "details": "设计并实现个人中心页面UI，包括用户头像、昵称、手机号/微信标识展示。实现账户设置入口，包括修改昵称、绑定手机号、隐私设置等。实现退出登录功能，清除本地token和用户信息。游客模式下个人中心显示引导注册入口。实现用户协议和隐私政策入口。",
            "status": "done",
            "testStrategy": "测试个人中心页面UI展示、用户信息显示、账户设置功能、退出登录功能，验证游客模式和正式用户模式的页面差异",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T13:25:26.970Z"
          },
          {
            "id": 19,
            "title": "实现手机号+验证码登录功能",
            "description": "开发手机号验证码登录的完整流程，包括验证码发送、校验和用户登录认证",
            "dependencies": [],
            "details": "1. 实现发送验证码接口，调用短信服务（如阿里云短信），设置验证码有效期5分钟，限制同一手机号1分钟内只能发送一次；2. 实现验证码校验接口，验证验证码正确性和时效性；3. 实现手机号登录接口，验证成功后生成JWT token并返回用户信息；4. 新用户自动注册并创建用户档案；5. 使用Redis存储验证码，设置过期时间；6. 实现验证码登录的异常处理（验证码错误、过期、手机号格式错误等）",
            "status": "done",
            "testStrategy": "测试验证码发送频率限制、验证码正确性校验、新用户自动注册、老用户正常登录、各种异常场景的处理",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:24:50.990Z"
          },
          {
            "id": 20,
            "title": "实现APP端微信授权登录",
            "description": "集成微信SDK，实现APP端的微信授权登录流程，包括前端授权和后端接口处理",
            "dependencies": [
              19
            ],
            "details": "1. 在APP端集成微信开放平台SDK，配置AppID和AppSecret；2. 实现微信授权按钮点击事件，调用wx.sendReq发起授权请求；3. 处理授权回调，获取微信返回的code；4. 后端实现微信登录接口，通过code调用微信API获取openid和session_key；5. 根据openid查询用户，存在则直接登录，不存在则创建新用户；6. 生成JWT token并返回用户信息；7. 处理授权失败、用户取消授权、网络异常等异常情况；8. 实现微信用户信息（昵称、头像）的绑定和更新逻辑",
            "status": "done",
            "testStrategy": "测试正常授权登录流程、首次授权自动注册、已授权用户直接登录、取消授权处理、网络异常处理、token生成和验证",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T05:44:16.817Z"
          },
          {
            "id": 21,
            "title": "实现小程序端微信授权登录",
            "description": "实现微信小程序端的静默授权登录，使用wx.login获取code并完成用户认证",
            "dependencies": [
              19
            ],
            "details": "1. 小程序端调用wx.login()获取临时登录凭证code；2. 将code发送到后端登录接口；3. 后端通过code调用微信接口获取openid和session_key；4. 根据openid判断用户是否存在，存在则返回token，不存在则创建新用户；5. 实现用户信息授权获取（昵称、头像），使用wx.getUserProfile；6. 复用JWT认证系统，统一登录状态管理；7. 处理code失效、接口调用失败等异常；8. 实现session_key的安全存储和定期刷新机制",
            "status": "done",
            "testStrategy": "测试小程序静默登录、用户信息授权获取、新用户自动注册、老用户登录、code失效处理、token有效期管理",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T05:50:55.416Z"
          },
          {
            "id": 22,
            "title": "实现游客模式及限制逻辑",
            "description": "开发游客模式登录功能，并实现游客用户的各项使用限制和引导注册机制",
            "dependencies": [
              19,
              20,
              21
            ],
            "details": "1. 实现游客登录接口，生成临时用户标识和JWT token；2. 在用户表中标记游客身份（isGuest字段）；3. 实现游客卜卦次数限制，使用Redis记录游客卜卦次数，最多允许2次；4. 实现游客历史记录不保存逻辑，卜卦结果不写入数据库；5. 实现付费功能访问限制，游客访问付费接口时返回错误提示；6. 实现游客卜卦2次后的引导注册弹窗，提示用户注册以继续使用；7. 游客注册后，将临时用户数据迁移到正式用户；8. 实现游客token的有效期管理（如7天过期）",
            "status": "done",
            "testStrategy": "测试游客登录、卜卦次数限制（第1次、第2次正常，第3次拦截）、历史记录不保存、付费功能限制、引导注册弹窗触发、游客转正式用户数据迁移",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:24:55.418Z"
          },
          {
            "id": 23,
            "title": "实现个人中心页面",
            "description": "开发用户个人中心页面，展示用户信息并提供账户管理功能",
            "dependencies": [
              19,
              20,
              21,
              22
            ],
            "details": "1. 设计个人中心页面UI布局，包括用户头像、昵称、手机号/微信标识显示；2. 实现用户信息展示接口，获取并展示用户基本资料；3. 实现用户信息编辑功能，支持修改昵称、上传头像；4. 实现账户安全设置，包括修改密码、绑定/解绑手机号、绑定/解绑微信；5. 实现游客用户在个人中心的注册引导入口；6. 实现退出登录功能，清除本地token和用户信息；7. 实现用户协议和隐私政策入口；8. 实现关于我们、版本信息等辅助功能；9. 处理游客用户和正式用户在个人中心的差异化展示",
            "status": "done",
            "testStrategy": "测试个人中心页面展示、用户信息修改、头像上传、账户安全设置、退出登录、游客用户引导注册、各种边界条件和异常处理",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T12:00:00.000Z"
          }
        ],
        "dependencies": [],
        "updatedAt": "2026-01-13T13:25:26.970Z",
        "complexity": 9,
        "recommendedSubtasks": 0,
        "expansionPrompt": "该任务已包含详细的子任务列表（ID 1-23），建议审查现有子任务的覆盖范围和依赖关系，确保后端API、前端实现及业务逻辑（如游客模式限制）的无缝衔接。"
      },
      {
        "id": 3,
        "title": "金钱课起卦功能开发",
        "description": "实现金钱课起卦功能,包括摇铜钱动画和一键起卦两种方式",
        "status": "done",
        "priority": "critical",
        "tags": [
          "divination",
          "core"
        ],
        "details": "需要实现:\n1. 摇铜钱动画:模拟真实摇铜钱,用户点击按钮或摇晃手机,连续摇6次生成卦象\n2. 一键起卦:简化流程,一次性生成卦象\n3. 两种方式可自由选择\n4. 卦象生成算法正确(六十四卦)",
        "acceptanceCriteria": [
          "摇铜钱动画流畅自然",
          "支持点击和摇晃两种触发方式",
          "连续摇6次正确生成卦象",
          "一键起卦功能正常",
          "生成的卦象符合金钱课规则",
          "六十四卦数据完整准确"
        ],
        "testStrategy": "测试起卦流程,验证卦象生成算法的正确性和随机性",
        "subtasks": [
          {
            "id": 1,
            "title": "六十四卦生成算法与数据结构实现",
            "description": "实现易经六十四卦的核心生成算法，定义卦象数据结构，确保随机性和准确性。",
            "dependencies": [],
            "details": "设计并实现六十四卦的数据结构（上卦、下卦、爻位）。编写基于铜钱正反面概率（通常为2正1反、3正、3反等）生成单爻的算法，循环6次生成完整卦象。确保算法覆盖所有64种可能性。",
            "status": "done",
            "testStrategy": "单元测试验证所有64种卦象均可生成，且概率分布符合易经金钱课规则。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:33:37.848Z"
          },
          {
            "id": 2,
            "title": "摇铜钱动画UI与交互逻辑开发",
            "description": "开发摇铜钱的视觉动画效果，实现点击按钮触发连续摇6次的交互流程。",
            "dependencies": [
              1
            ],
            "details": "使用前端动画库（如Lottie或CSS动画）制作铜钱旋转、抛掷的3D效果。实现点击“摇一摇”按钮后，触发动画序列，每次摇动生成一爻，共6次。动画结束后展示当前生成的爻。",
            "status": "pending",
            "testStrategy": "UI测试验证动画流畅度，交互测试验证点击按钮能正确触发6次摇动并停止。",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "手机传感器（摇一摇）集成与事件处理",
            "description": "集成设备加速度计传感器，实现摇晃手机触发起卦的功能，并优化触发灵敏度。",
            "dependencies": [
              1
            ],
            "details": "调用原生API获取加速度计数据。编写算法检测摇动动作（加速度阈值和持续时间）。设置防抖机制防止误触发。当检测到有效摇动时，调用起卦算法并触发UI动画。",
            "status": "pending",
            "testStrategy": "真机测试验证不同力度摇晃手机是否能触发起卦，测试静止时是否误触发。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "一键起卦功能与结果展示",
            "description": "实现一键快速生成卦象的功能，并设计最终的卦象结果展示页面。",
            "dependencies": [
              1,
              2
            ],
            "details": "开发“一键起卦”按钮，点击后直接调用算法生成完整卦象，跳过中间动画过程。设计结果展示页，显示卦名、卦辞、爻辞等信息。确保两种起卦方式（摇铜钱、一键）的结果展示页面复用。",
            "status": "pending",
            "testStrategy": "功能测试验证一键起卦能立即生成结果，UI测试验证结果展示页面的信息完整性和准确性。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 6,
        "recommendedSubtasks": 4,
        "expansionPrompt": "请将任务分解为：1. 六十四卦生成算法与数据结构实现；2. 摇铜钱动画UI与交互逻辑开发；3. 手机传感器（摇一摇）集成与事件处理；4. 一键起卦功能与结果展示。",
        "updatedAt": "2026-01-13T04:06:31.084Z"
      },
      {
        "id": 4,
        "title": "基础解卦功能开发",
        "description": "实现基础解卦功能(免费),包括卦象名称、卦辞原文、爻辞原文、白话解释",
        "status": "done",
        "priority": "critical",
        "tags": [
          "divination",
          "content"
        ],
        "details": "需要实现:\n1. 显示卦象名称(如'乾为天')\n2. 显示卦辞原文(传统通行本王弼注本)\n3. 显示六爻爻辞原文\n4. 显示卦辞和爻辞的白话解释\n5. 六十四卦的完整内容数据",
        "acceptanceCriteria": [
          "卦象名称正确显示",
          "卦辞爻辞原文准确完整",
          "白话解释清晰易懂",
          "六十四卦数据完整准确",
          "页面排版美观易读"
        ],
        "testStrategy": "验证每一卦的内容准确性,测试各种卦象的显示效果",
        "subtasks": [
          {
            "id": 1,
            "title": "六十四卦基础数据整理与录入",
            "description": "整理、录入并校对六十四卦的卦名、卦辞原文、爻辞原文及白话解释数据。",
            "dependencies": [],
            "details": "收集六十四卦的完整内容，包括卦名（如乾为天）、卦辞（采用传统通行本王弼注本）、六爻爻辞原文以及对应的白话文解释。将数据整理成结构化格式（如JSON），并录入到数据库中。需进行多轮校对，确保繁简字转换正确、标点符号准确、白话解释通顺。",
            "status": "pending",
            "testStrategy": "随机抽取多个卦象，对比权威古籍原文进行数据准确性校验；检查数据库字段完整性及数据格式规范性。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "基础解卦页面UI开发与数据渲染",
            "description": "开发基础解卦功能的前端页面，实现卦象信息的查询接口调用与界面展示。",
            "dependencies": [
              1
            ],
            "details": "设计解卦结果展示页面的UI布局，需清晰展示卦象名称、卦辞原文、六爻爻辞列表及白话解释。开发后端查询接口，支持根据卦象ID获取完整数据。前端实现数据渲染逻辑，优化长文本阅读体验，确保在不同设备上的显示效果良好。",
            "status": "pending",
            "testStrategy": "遍历测试六十四卦的显示效果，验证文字排版无错乱；测试接口响应速度及数据加载状态；检查UI在不同分辨率下的适配情况。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 3,
        "recommendedSubtasks": 2,
        "expansionPrompt": "请将任务分解为：1. 六十四卦基础数据（卦名、卦辞、爻辞）的整理、录入与校对；2. 基础解卦页面的UI开发与数据渲染。",
        "updatedAt": "2026-01-13T00:22:52.969Z"
      },
      {
        "id": 5,
        "title": "详细解卦功能开发(付费)",
        "description": "实现详细解卦功能(付费),包括变卦分析、互卦分析、应期分析等高级分析",
        "status": "in-progress",
        "priority": "critical",
        "tags": [
          "divination",
          "premium"
        ],
        "details": "需要实现:\n1. 包含基础解卦所有内容\n2. 变卦分析:分析爻变后的卦象变化\n3. 互卦分析:分析互卦的含义\n4. 应期分析:预测应验时间\n5. 其他高级分析要素\n6. 付费功能引导(非会员查看时弹窗提示)\n7. 会员权益展示和购买入口",
        "acceptanceCriteria": [
          "变卦分析准确专业",
          "互卦分析准确专业",
          "应期分析逻辑清晰",
          "付费引导弹窗正确触发",
          "会员权益页面完整展示",
          "购买流程顺畅"
        ],
        "testStrategy": "测试付费功能的权限控制,验证高级分析内容的专业性",
        "subtasks": [
          {
            "id": 1,
            "title": "高级解卦算法后端实现",
            "description": "实现变卦、互卦、应期等高级分析的后端逻辑与规则引擎",
            "dependencies": [],
            "details": "基于易经理论开发变卦分析逻辑（分析爻变后的卦象变化）、互卦分析逻辑（分析互卦的含义）以及应期分析逻辑（预测应验时间）。整合其他高级分析要素，确保算法输出结构化数据供前端展示，并包含基础解卦的所有内容。",
            "status": "done",
            "testStrategy": "验证不同卦象组合下变卦、互卦、应期分析结果的准确性和专业性",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:38:05.102Z"
          },
          {
            "id": 2,
            "title": "付费权限控制与引导逻辑开发",
            "description": "开发付费功能权限校验中间件及非会员引导弹窗逻辑",
            "dependencies": [],
            "details": "实现中间件以检查用户会员状态。如果用户不是会员，拦截详细解卦请求并返回特定的错误代码或触发前端引导弹窗。定义非会员查看详细解卦时的弹窗提示内容和交互逻辑，确保与用户系统（Task 2）的会员状态正确对接。",
            "status": "done",
            "testStrategy": "测试会员与非会员访问详细解卦接口的权限控制，验证弹窗触发时机和内容展示",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T00:38:09.238Z"
          },
          {
            "id": 3,
            "title": "详细解卦页面UI与富文本展示",
            "description": "开发详细解卦页面的前端界面，实现高级分析结果的富文本展示",
            "dependencies": [
              1,
              2
            ],
            "details": "设计并实现详细解卦页面UI。使用富文本组件展示变卦、互卦、应期等复杂的分析内容。处理付费引导弹窗的显示逻辑（基于后端响应）。确保页面布局美观，符合周易文化风格，且在移动端适配良好。",
            "status": "pending",
            "testStrategy": "验证页面UI还原度，测试富文本内容的渲染效果及不同屏幕尺寸下的适配性",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "会员权益展示与购买入口集成",
            "description": "实现会员权益展示页面及购买入口的跳转逻辑",
            "dependencies": [
              2,
              3
            ],
            "details": "在引导弹窗或详细解卦页面中集成会员权益展示模块（如会员特权列表）。实现“立即开通”或“查看会员”按钮的跳转逻辑，跳转至支付/会员购买页面。确保购买流程顺畅，购买成功后能自动解锁详细解卦功能。",
            "status": "pending",
            "testStrategy": "测试从引导弹窗点击购买入口的跳转流程，验证会员权益展示内容的准确性",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 7,
        "recommendedSubtasks": 4,
        "expansionPrompt": "请将任务分解为：1. 变卦、互卦、应期等高级分析算法/规则的后端实现；2. 付费权限控制中间件与引导弹窗逻辑；3. 详细解卦页面UI开发与富文本展示；4. 会员权益展示与购买入口跳转。",
        "updatedAt": "2026-01-13T00:38:09.238Z"
      },
      {
        "id": 6,
        "title": "精准解卦功能开发(付费)",
        "description": "实现精准解卦功能(付费),需要收集用户个人信息进行精准解读",
        "status": "in-progress",
        "priority": "high",
        "tags": [
          "divination",
          "premium"
        ],
        "details": "需要实现:\n1. 用户信息收集表单(姓名、性别、出生日期、占问事项)\n2. 基于个人信息的精准解读算法\n3. 与详细解卦的内容整合\n4. 付费权限控制",
        "acceptanceCriteria": [
          "信息收集表单完整易用",
          "精准解读结果专业准确",
          "与详细解卦内容良好整合",
          "付费权限正确控制"
        ],
        "testStrategy": "测试信息收集流程,验证精准解读的专业性",
        "subtasks": [
          {
            "id": 1,
            "title": "开发用户信息收集表单（含多端适配与交互优化）",
            "description": "实现姓名、性别、出生日期（支持农历）、占问事项的收集表单，修复小程序Textarea问题，优化APP端页面交互、键盘处理及无障碍支持。",
            "dependencies": [],
            "details": "1. 设计并实现表单UI组件，包含姓名输入、性别选择、出生日期选择器、占问事项文本域。2. 修复小程序端Textarea导入问题，确保输入正常。3. 创建APP端表单页面，确保UI风格统一。4. 优化表单交互体验，包括输入验证、实时错误提示、必填项检查。5. 添加无障碍支持标签，提升可访问性。6. 优化键盘弹出时的页面布局处理，防止遮挡输入框。7. 实现农历日期选择功能（作为可选特性）。",
            "status": "pending",
            "testStrategy": "验证表单在APP和小程序端的显示与交互一致性；测试键盘弹出时不遮挡输入框；验证农历日期选择功能是否正常工作；检查无障碍标签是否完整。"
          },
          {
            "id": 2,
            "title": "实现精准解读后端逻辑与付费权限控制",
            "description": "开发基于用户个人信息的精准解读算法，并集成付费权限验证逻辑，确保只有付费用户才能调用精准解读接口。",
            "dependencies": [],
            "details": "1. 设计并实现精准解读算法接口，接收前端传递的用户信息（姓名、生辰、事项）。2. 集成付费权限验证中间件，检查用户订单状态或会员权益。3. 将用户信息参数注入到解卦逻辑中，生成定制化解读内容。4. 编写单元测试验证算法逻辑的正确性和权限控制的有效性。",
            "status": "pending",
            "testStrategy": "测试未付费用户调用接口时是否正确返回权限错误；验证付费用户能成功获取包含个性化信息的解读结果；检查算法生成的定制化内容是否符合业务规则。"
          },
          {
            "id": 3,
            "title": "整合精准解读结果至详细解卦页面",
            "description": "将后端返回的精准解读数据整合到现有的详细解卦页面中，确保数据展示流畅，并处理加载状态和错误情况。",
            "dependencies": [
              1,
              2
            ],
            "details": "1. 修改详细解卦页面的API调用逻辑，传入从表单收集的用户信息参数。2. 解析后端返回的精准解读数据结构，适配前端展示模型。3. 在页面UI中渲染精准解读内容，设计样式以区分或融合通用解卦内容。4. 处理网络请求的加载状态（Loading）和异常提示（Error Handling）。5. 进行端到端测试，验证从表单提交到结果展示的完整用户流程。",
            "status": "pending",
            "testStrategy": "验证表单提交后能正确跳转至详情页并加载数据；检查精准解读内容是否在页面上正确渲染；测试网络异常或权限不足时的错误提示是否友好。"
          }
        ],
        "dependencies": [],
        "complexity": 5,
        "recommendedSubtasks": 3,
        "expansionPrompt": "请将任务分解为：1. 用户信息收集表单（姓名、生辰等）的开发与验证；2. 基于用户信息的精准解读后端逻辑实现；3. 精准解读结果与详细解卦页面的整合。",
        "updatedAt": "2026-01-13T00:42:51.082Z"
      },
      {
        "id": 7,
        "title": "学习路径功能开发",
        "description": "实现零基础入门学习路径,包括5个课程模块和互动测验",
        "status": "done",
        "priority": "high",
        "tags": [
          "education",
          "content"
        ],
        "details": "需要实现:\n1. 六十四卦解读方法\n2. 如何起卦\n3. 八卦介绍\n4. 如何看卦\n5. 周易起源与历史\n6. 每课1-3分钟阅读内容\n7. 配图和示意图解\n8. 互动练习选择题\n9. 学习进度保存\n10. 完成全部学习后解锁免费详细解卦1次",
        "acceptanceCriteria": [
          "5个课程模块内容完整",
          "内容形式丰富(文字+配图+图解)",
          "互动测验功能正常",
          "学习进度正确保存",
          "完成奖励正确解锁"
        ],
        "testStrategy": "测试学习流程,验证内容质量和互动功能",
        "subtasks": [
          {
            "id": 1,
            "title": "课程内容结构设计与后台数据录入",
            "description": "设计5个课程模块的数据结构，并在后台管理系统中录入周易相关课程内容。",
            "dependencies": [],
            "details": "定义课程、章节、内容的JSON Schema。录入5个模块（六十四卦解读、如何起卦、八卦介绍、如何看卦、周易起源）。每课1-3分钟阅读内容，包含配图和示意图解。",
            "status": "pending",
            "testStrategy": "验证后台录入的数据格式正确，前端能正确解析并显示。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "课程学习阅读器UI开发",
            "description": "开发支持图文混排的课程阅读界面，提供流畅的用户阅读体验。",
            "dependencies": [
              1
            ],
            "details": "实现阅读器UI组件，支持富文本展示、图片加载、章节导航。适配移动端屏幕，优化排版和字体大小，确保阅读体验舒适。",
            "status": "done",
            "testStrategy": "测试不同设备上的图文显示效果，验证翻页和导航功能是否正常。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T12:00:00.000Z"
          },
          {
            "id": 3,
            "title": "互动测验功能与答案校验逻辑",
            "description": "实现课程结束后的互动选择题功能，并开发答案校验逻辑。",
            "dependencies": [
              1
            ],
            "details": "设计测验UI组件，支持单选/多选题。实现前端答案校验逻辑，即时反馈正确/错误状态。关联测验数据与课程内容。",
            "status": "done",
            "testStrategy": "测试各种题型的答题流程，验证校验逻辑的准确性及反馈提示。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T12:00:00.000Z"
          },
          {
            "id": 4,
            "title": "学习进度本地存储与完成奖励发放",
            "description": "实现学习进度的本地持久化存储，以及完成全部课程后的奖励机制。",
            "dependencies": [
              2,
              3
            ],
            "details": "使用LocalStorage或AsyncStorage存储用户学习状态（已读章节、测验完成情况）。检测全部课程完成状态，触发解锁免费详细解卦1次的奖励逻辑，更新用户账户权益。",
            "status": "pending",
            "testStrategy": "验证刷新页面后进度不丢失，测试完成全部课程后奖励是否正确发放。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 5,
        "recommendedSubtasks": 4,
        "expansionPrompt": "请将任务分解为：1. 课程内容结构设计与后台数据录入；2. 课程学习阅读器UI开发（支持图文）；3. 互动测验功能与答案校验逻辑；4. 学习进度本地存储与完成奖励发放。",
        "updatedAt": "2026-01-13T04:10:10.045Z"
      },
      {
        "id": 8,
        "title": "每日一卦功能开发",
        "description": "实现每日一卦推送功能,包括固定时间推送和当日卦象展示",
        "status": "done",
        "priority": "high",
        "tags": [
          "push",
          "content"
        ],
        "details": "需要实现:\n1. 每天早上8点推送当日卦象+卦辞\n2. 当日卦象展示页面\n3. 历史记录查看(会员专享)\n4. 数据不保存过期失效\n5. 点击推送直接进入解释页面\n6. 推送开关设置",
        "acceptanceCriteria": [
          "推送时间准确",
          "推送内容完整",
          "当日卦象页面展示清晰",
          "历史记录权限控制正确",
          "推送跳转正确"
        ],
        "testStrategy": "测试推送功能和页面展示,验证权限控制",
        "subtasks": [
          {
            "id": 1,
            "title": "后端定时任务开发与卦象生成逻辑",
            "description": "实现每天早上8点自动生成当日卦象及卦辞的后端逻辑，确保数据按时生成。",
            "dependencies": [],
            "details": "配置后端Cron Job调度器，编写随机或特定算法生成每日卦象数据（卦象、卦名、卦辞），处理跨时区逻辑，确保每日数据唯一且在指定时间生成。",
            "status": "pending",
            "testStrategy": "验证定时任务是否准时触发，检查生成的卦象数据格式是否正确且完整。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "第三方推送服务集成与消息发送",
            "description": "集成个推或极光推送服务，实现根据用户设置发送每日卦象推送通知。",
            "dependencies": [
              1
            ],
            "details": "接入第三方推送SDK，管理用户设备Token，在定时任务生成卦象后调用推送接口，根据用户开关状态筛选推送对象，配置点击推送跳转至解释页面的参数。",
            "status": "pending",
            "testStrategy": "测试推送消息的到达率和展示效果，验证点击推送能正确跳转至对应的卦象解释页面。",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "每日一卦展示页面开发",
            "description": "开发前端展示页面，用于显示当日卦象、卦辞及详细解释，并处理数据过期逻辑。",
            "dependencies": [
              1
            ],
            "details": "设计并实现每日一卦UI界面，调用后端接口获取当日数据，展示卦象图形、卦名、卦辞和详细解释。实现本地缓存机制，确保数据不保存过期失效，次日自动刷新。",
            "status": "done",
            "testStrategy": "检查页面UI布局与交互体验，验证数据加载正确性及过期失效逻辑是否按预期工作。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T12:00:00.000Z"
          },
          {
            "id": 4,
            "title": "推送开关设置与历史记录权限控制",
            "description": "实现用户推送开关设置功能，以及历史记录查看的会员权限控制逻辑。",
            "dependencies": [
              2,
              3
            ],
            "details": "在设置页面开发推送开关UI，保存用户偏好状态至后端。开发历史记录列表接口和页面，校验用户会员身份，非会员限制查看历史记录，仅会员可查看完整历史。",
            "status": "pending",
            "testStrategy": "验证推送开关状态变更是否生效，测试会员与非会员查看历史记录的权限隔离是否正确。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 6,
        "recommendedSubtasks": 4,
        "expansionPrompt": "请将任务分解为：1. 后端定时任务（Cron Job）开发，实现每日卦象生成；2. 第三方推送服务（个推/极光）的集成与消息发送；3. 每日一卦展示页面开发；4. 推送开关设置与历史记录权限控制。",
        "updatedAt": "2026-01-13T04:12:54.142Z"
      },
      {
        "id": 9,
        "title": "历史记录功能开发",
        "description": "实现卜卦历史记录功能,包括卡片式展示和用户权限差异",
        "status": "pending",
        "priority": "medium",
        "tags": [
          "history",
          "storage"
        ],
        "details": "需要实现:\n1. 卡片式展示(日期+卦象名称+卦象符号+简短结果)\n2. 免费用户:仅保存1条、保存1个月、不可删除\n3. 付费用户:无限制保存、永久保存、支持单条删除或清空全部\n4. 云端同步\n5. 多设备自动同步\n6. 离线查看支持",
        "acceptanceCriteria": [
          "卡片展示清晰美观",
          "免费用户限制正确实施",
          "付费用户权限完全开放",
          "云端同步功能正常",
          "多设备同步准确",
          "离线查看功能正常"
        ],
        "testStrategy": "测试各种用户权限的记录保存和同步功能",
        "subtasks": [
          {
            "id": 1,
            "title": "历史记录数据库设计与API开发",
            "description": "设计历史记录数据模型，实现后端API接口，支持分页查询和筛选功能。",
            "dependencies": [
              2
            ],
            "details": "设计数据库表结构，包含用户ID、卦象详情、创建时间等字段。开发增删改查API，实现分页逻辑及按日期/类型筛选功能，确保数据结构支持后续的同步需求。",
            "status": "pending",
            "testStrategy": "单元测试API接口，验证分页和筛选逻辑准确性，确保数据读写无误。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "云端同步逻辑与冲突解决策略",
            "description": "实现多设备间的数据自动同步机制，并制定数据冲突时的解决策略。",
            "dependencies": [
              1
            ],
            "details": "基于时间戳或版本号实现增量同步机制。定义冲突解决策略（如最新写入优先或服务端优先），处理网络异常重试逻辑，确保多设备数据最终一致性。",
            "status": "pending",
            "testStrategy": "模拟多设备并发修改场景，验证冲突解决机制是否按预期工作，检查数据同步完整性。",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "免费与付费用户权限差异化实现",
            "description": "根据用户订阅状态，实现历史记录保存数量、时长及删除权限的差异化控制。",
            "dependencies": [
              1
            ],
            "details": "在API层增加权限校验中间件。免费用户限制保存1条且1个月后自动清理，禁止删除操作；付费用户无限制保存且支持单条删除或清空全部。",
            "status": "pending",
            "testStrategy": "分别使用免费和付费账号测试边界条件，验证保存限制、自动清理及删除权限是否生效。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "历史记录列表UI与卡片式布局开发",
            "description": "开发前端历史记录页面，实现卡片式布局展示卜卦结果，包含日期、卦象名称等信息。",
            "dependencies": [
              1
            ],
            "details": "开发卡片组件，展示日期、卦象名称、卦象符号及简短结果。实现列表滚动加载及空状态展示，确保UI在iOS、Android及小程序端的适配性。",
            "status": "done",
            "testStrategy": "UI测试，检查不同屏幕尺寸下的布局适配效果，验证数据渲染的正确性及交互流畅度。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T12:00:00.000Z"
          },
          {
            "id": 5,
            "title": "本地离线缓存策略与数据同步",
            "description": "实现本地数据库存储，支持离线查看历史记录，并在网络恢复时自动同步数据。",
            "dependencies": [
              2,
              4
            ],
            "details": "使用本地数据库（如SQLite或Realm）存储历史记录。实现离线读写能力，开发后台同步队列，在网络恢复时自动合并本地与云端数据，并更新UI状态。",
            "status": "pending",
            "testStrategy": "断网环境下测试查看和新增记录，恢复网络后验证数据自动同步及一致性，确保无数据丢失。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 7,
        "recommendedSubtasks": 5,
        "expansionPrompt": "请将任务分解为：1. 历史记录数据库设计与API开发（含分页、筛选）；2. 云端同步逻辑与冲突解决策略；3. 免费与付费用户的权限差异化实现；4. 历史记录列表UI与卡片式布局开发；5. 本地离线缓存策略与数据同步。"
      },
      {
        "id": 10,
        "title": "会员和支付功能开发（模拟支付）",
        "description": "实现会员购买功能，使用模拟支付接口打通流程，真实支付SDK集成延后至生产环境",
        "status": "done",
        "priority": "high",
        "tags": [
          "payment",
          "premium",
          "mock"
        ],
        "details": "需要实现:\n1. 按次详细解卦:10元/次\n2. 会员月费:30元/月\n3. 会员年费:300元/年\n4. 会员权益管理(详细解卦、精准解卦、收藏、无限制、无广告、专属客服、每日一卦历史、历史记录管理)\n5. 模拟支付接口(本地实现，模拟支付成功/失败)\n6. 会员状态管理\n7. 到期时间管理\n8. 真实支付SDK集成延后(微信/支付宝)\n\n⚠️ 重要: 先使用模拟支付完成整个支付流程，真实支付SDK集成在生产环境前完成",
        "acceptanceCriteria": [
          "模拟支付流程完整可用",
          "会员权益正确实施",
          "会员状态准确管理",
          "到期提醒功能正常",
          "支付失败重试机制正常"
        ],
        "testStrategy": "使用模拟支付测试完整支付流程,验证会员权益和状态管理。真实支付集成在生产环境前完成",
        "subtasks": [
          {
            "id": 1,
            "title": "会员订单系统与状态管理后端开发",
            "description": "设计并实现会员订单数据库模型、订单状态流转逻辑以及会员状态管理接口",
            "dependencies": [],
            "details": "创建订单表（包含订单号、用户ID、商品类型、金额、状态、创建时间、支付时间等字段）。实现订单状态机（待支付、已支付、已取消、已退款）。开发会员状态管理服务，支持按次付费（10元）、月费（30元）、年费（300元）的配置与处理，以及会员到期时间的自动计算与更新。",
            "status": "completed",
            "testStrategy": "编写单元测试验证订单状态流转逻辑，通过接口测试验证会员状态更新及到期时间计算的准确性。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "模拟支付接口实现（本地Mock）",
            "description": "实现本地模拟支付服务，模拟微信/支付宝支付的成功、失败、取消等场景",
            "dependencies": [
              1
            ],
            "details": "创建模拟支付服务，支持模拟支付成功（立即返回已支付状态）、模拟支付失败（返回失败原因）、模拟支付取消（用户主动取消）、模拟网络延迟（2-5秒随机延迟）。提供开发者模式开关，可以快速切换不同支付场景。预留真实支付SDK集成接口，确保后续可以无缝切换。",
            "status": "completed",
            "testStrategy": "测试模拟支付的各种场景（成功、失败、取消、超时），验证订单状态更新正确，验证前端交互流程完整。",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "会员权益验证中间件实现",
            "description": "开发后端中间件和前端权限校验逻辑，确保会员权益（如详细解卦、无广告等）正确生效",
            "dependencies": [
              1
            ],
            "details": "后端实现权限验证中间件，拦截请求并校验用户会员状态、到期时间及剩余次数。前端实现路由守卫和功能点权限控制。具体权益包括：详细解卦、精准解卦、收藏功能、无限制使用、无广告体验、专属客服入口、每日一卦历史查看及历史记录管理。按次付费用户需实现次数扣减逻辑。",
            "status": "completed",
            "testStrategy": "测试不同会员等级（月卡、年卡、按次）及游客模式下的功能访问权限，验证权益控制逻辑无漏洞。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "会员购买页面UI开发",
            "description": "开发会员套餐选择页面、支付方式选择页面及支付结果展示页面",
            "dependencies": [
              1,
              2
            ],
            "details": "设计并实现会员套餐列表UI，清晰展示按次（10元）、月卡（30元）、年卡（300元）的价格及权益对比。集成支付方式选择（模拟微信/支付宝）。对接后端模拟支付接口，实现唤起支付的交互逻辑。开发支付成功后的成功页及支付失败的重试引导页。",
            "status": "completed",
            "testStrategy": "进行UI/UX测试，验证页面布局在不同设备上的适配性，并测试从选择套餐到支付完成的完整交互流程。",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "支付异常处理与重试机制",
            "description": "实现支付过程中的异常捕获、重试机制以及支付结果页面展示",
            "dependencies": [
              2
            ],
            "details": "处理模拟支付的各种异常场景（网络超时、支付失败、余额不足等）。实现支付失败后的重试机制（支持重新支付）。提供友好的错误提示和解决建议。实现支付结果确认页面，展示订单详情和权益说明。",
            "status": "completed",
            "testStrategy": "模拟各种支付异常场景，验证错误提示清晰友好，验证重试机制正常工作，验证支付结果页面信息准确。",
            "parentId": "undefined"
          },
          {
            "id": 6,
            "title": "会员订单管理功能实现",
            "description": "实现会员订单查询、历史记录、发票管理等功能",
            "dependencies": [
              1
            ],
            "details": "开发订单列表页面，展示用户的历史订单（按次、月卡、年卡）。实现订单详情查看，包括订单状态、支付金额、购买时间、到期时间等。支持根据订单状态筛选（全部、已支付、已取消）。实现发票申请入口（功能预留）。提供订阅管理功能，支持取消订阅（针对自动续费用户）。",
            "status": "completed",
            "testStrategy": "验证订单列表展示正确，订单详情信息完整，筛选功能正常，取消订阅逻辑正确执行。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 9,
        "recommendedSubtasks": 6,
        "expansionPrompt": "请将任务分解为：1. 会员订单系统与状态管理后端开发；2. 微信支付SDK集成与回调处理；3. 支付宝支付SDK集成与回调处理；4. 会员权益验证中间件实现；5. 会员购买页面UI开发；6. 支付异常处理与对账逻辑。",
        "updatedAt": "2026-01-13T12:30:00.000Z"
      },
      {
        "id": 11,
        "title": "UI界面设计和开发",
        "description": "实现传统中国风的UI界面设计,包括首页、各功能页面和深色模式",
        "status": "done",
        "priority": "critical",
        "tags": [
          "ui",
          "design"
        ],
        "details": "需要实现:\n1. 传统中国风设计风格(水墨、书法、古典元素)\n2. 传统中国色配色方案(墨黑、朱红、古铜金等)\n3. 5个Tab底部导航栏(卜卦、学习、每日一卦、历史、我的)\n4. 启动页(APP名称+传统元素+每日一句易经名言)\n5. 深色模式支持\n6. 各功能页面UI开发",
        "acceptanceCriteria": [
          "设计风格统一符合中国风",
          "配色方案美观协调",
          "导航栏功能正常",
          "启动页效果良好",
          "深色模式切换正常",
          "各页面UI完整美观"
        ],
        "testStrategy": "验证设计风格一致性,测试各页面和深色模式",
        "subtasks": [
          {
            "id": 1,
            "title": "中国风设计系统规范制定",
            "description": "定义颜色、字体、间距和基础组件以建立视觉一致性",
            "dependencies": [],
            "details": "创建包含传统中国色（墨黑、朱红、古铜金等）的设计令牌，选择书法字体，定义标准间距、圆角，并设计基础UI组件（按钮、卡片、输入框），采用水墨和古典元素风格。",
            "status": "pending",
            "testStrategy": "审查设计令牌和组件库，确保符合传统美学和开发规范",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "全局导航栏与路由架构搭建",
            "description": "实现底部TabBar导航和页面路由结构",
            "dependencies": [
              1
            ],
            "details": "开发包含5个标签（卜卦、学习、每日一卦、历史、我的）的底部TabBar，使用设计系统中的图标和样式。配置路由架构以处理页面间的导航和状态保持。",
            "status": "pending",
            "testStrategy": "测试标签间的导航切换，验证选中状态、图标显示及路由跳转逻辑",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "核心功能页面UI实现",
            "description": "开发主要功能页面（首页、卜卦、学习等）的UI",
            "dependencies": [
              1,
              2
            ],
            "details": "使用设计系统实现首页、卜卦、学习、历史和我的页面的布局。整合水墨背景、书法标题和古典装饰元素。确保布局在不同屏幕尺寸下的响应式适配。",
            "status": "pending",
            "testStrategy": "进行视觉回归测试，检查所有页面上的对齐、间距、文字排版和风格一致性",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "深色模式适配与主题切换逻辑",
            "description": "实现深色模式主题和切换机制",
            "dependencies": [
              1,
              3
            ],
            "details": "扩展设计系统以包含深色模式调色板（如深墨色背景）。实现主题切换逻辑（跟随系统或手动切换）。将深色样式应用到所有组件和页面，确保对比度符合可读性标准。",
            "status": "pending",
            "testStrategy": "在浅色和深色模式之间反复切换，验证颜色对比度、文字可读性和风格一致性",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "启动页动画与全局过渡效果",
            "description": "创建启动页并实现页面过渡动画",
            "dependencies": [
              1,
              2
            ],
            "details": "设计并实现启动页，包含APP名称、传统视觉元素和每日一句易经名言的动态展示。添加全局页面过渡动画（如淡入淡出、滑动），以增强传统中国风的沉浸感。",
            "status": "pending",
            "testStrategy": "测试启动动画的流畅度和持续时间，验证页面过渡是否平滑且无卡顿现象",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 8,
        "recommendedSubtasks": 5,
        "expansionPrompt": "请将任务分解为：1. 中国风设计系统规范制定（颜色、字体、组件）；2. 全局导航栏（TabBar）与路由架构搭建；3. 核心功能页面（首页、卜卦等）的UI实现；4. 深色模式适配与主题切换逻辑；5. 启动页动画与全局过渡效果。",
        "updatedAt": "2026-01-13T00:24:59.827Z"
      },
      {
        "id": 12,
        "title": "第三方服务集成（支付SDK延后）",
        "description": "集成微信登录、短信验证、推送等第三方服务。真实支付SDK集成延后至生产环境前",
        "status": "pending",
        "priority": "medium",
        "tags": [
          "integration",
          "external"
        ],
        "details": "需要集成:\n1. 微信开放平台授权登录\n2. 短信验证码服务\n3. 推送服务(个推/极光/厂商推送)\n4. 微信支付SDK（延后至生产环境）\n5. 支付宝支付SDK（延后至生产环境）\n\n⚠️ 重要说明: 微信/支付宝支付SDK集成延后，当前使用模拟支付实现。生产环境部署前完成真实支付SDK集成。",
        "acceptanceCriteria": [
          "微信登录功能正常",
          "短信验证码功能正常",
          "推送功能正常"
        ],
        "testStrategy": "测试各第三方服务的集成和功能（除支付SDK外）。支付SDK在生产环境前完成集成测试",
        "subtasks": [
          {
            "id": 1,
            "title": "微信开放平台登录集成（APP与小程序）",
            "description": "集成微信开放平台授权登录功能，支持APP端和小程序端的用户身份验证。",
            "dependencies": [],
            "details": "接入微信开放平台SDK，实现APP端和小程序端的OAuth2.0授权流程，处理code换取session_key及用户信息，确保UnionID统一。",
            "status": "pending",
            "testStrategy": "测试APP和小程序端的授权跳转、回调处理及异常情况（如用户取消）。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "短信验证码服务对接与防刷逻辑",
            "description": "对接第三方短信服务商，实现验证码发送与校验，并包含防刷机制。",
            "dependencies": [],
            "details": "选择短信服务商（如阿里云/腾讯云），配置签名和模板，实现发送接口；设计并实现基于IP、手机号和图形验证码的防刷限流策略。",
            "status": "pending",
            "testStrategy": "测试验证码发送时效性、格式正确性，以及高频触发拦截效果。",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "微信支付SDK集成（延后至生产环境）",
            "description": "集成微信支付功能，支持APP支付及小程序支付，处理支付回调。（⚠️ 低优先级：生产环境前完成）",
            "dependencies": [],
            "details": "接入微信支付SDK，实现统一下单、调起支付、支付状态查询接口；配置异步回调通知URL，处理支付结果更新订单状态。⚠️ 当前使用模拟支付，此任务可在生产环境部署前完成。",
            "status": "pending",
            "testStrategy": "使用微信支付沙箱环境测试下单、支付成功、支付取消及退款流程。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "支付宝支付SDK集成（延后至生产环境）",
            "description": "集成支付宝支付功能，支持APP端支付接入，处理支付结果通知。（⚠️ 低优先级：生产环境前完成）",
            "dependencies": [],
            "details": "接入支付宝SDK，实现订单生成与支付调起；配置RSA公私钥，处理同步返回和异步通知，确保订单状态一致性。⚠️ 当前使用模拟支付，此任务可在生产环境部署前完成。",
            "status": "pending",
            "testStrategy": "使用支付宝沙箱环境测试完整支付流程，验证签名验证及金额准确性。",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "消息推送服务（厂商通道）配置与测试",
            "description": "配置第三方推送服务及各手机厂商通道，实现APP消息推送功能。",
            "dependencies": [],
            "details": "集成个推或极光推送SDK，申请并配置华为、小米、OPPO、VIVO等厂商通道权限；实现客户端Token上报及服务端消息下发接口。",
            "status": "pending",
            "testStrategy": "测试不同品牌手机在APP前台、后台及被杀进程状态下的消息到达率。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 8,
        "recommendedSubtasks": 5,
        "expansionPrompt": "请将任务分解为：1. 微信开放平台登录集成（APP与小程序）；2. 短信验证码服务对接与防刷逻辑；3. 微信支付接口对接；4. 支付宝支付接口对接；5. 消息推送服务（厂商通道）的配置与测试。",
        "updatedAt": "2026-01-13T12:30:00.000Z"
      },
      {
        "id": 13,
        "title": "数据安全和隐私保护",
        "description": "实现用户数据加密存储、HTTPS传输、隐私保护等措施",
        "status": "done",
        "priority": "critical",
        "tags": [
          "security",
          "privacy"
        ],
        "details": "需要实现:\n1. 用户数据加密存储\n2. HTTPS加密传输\n3. 符合个人信息保护法要求\n4. 用户注销功能(删除所有数据)\n5. 隐私政策和用户协议",
        "acceptanceCriteria": [
          "敏感数据加密存储",
          "全站HTTPS传输",
          "隐私政策完整合规",
          "用户协议完整合规",
          "注销功能完全删除数据"
        ],
        "testStrategy": "进行安全测试,验证数据保护和注销功能",
        "subtasks": [
          {
            "id": 1,
            "title": "全站HTTPS证书配置与传输加密实施",
            "description": "配置SSL证书，强制全站HTTPS访问，确保数据传输链路安全。",
            "dependencies": [
              1
            ],
            "details": "申请SSL/TLS证书（推荐使用Let's Encrypt或云服务商证书），在Nginx/反向代理层配置证书，设置HTTP自动跳转HTTPS（301重定向），开启HSTS头部，禁用弱加密算法套件。",
            "status": "pending",
            "testStrategy": "使用浏览器检查锁头图标，使用SSL Labs工具测试评级，验证HTTP请求是否强制跳转。",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "敏感数据加密存储方案实现",
            "description": "实现数据库层面的敏感字段加密，保护用户手机号等隐私信息。",
            "dependencies": [
              2
            ],
            "details": "选择AES-256或RSA算法，开发加密/解密中间件或工具类，修改用户表Schema存储密文，对现有数据进行加密迁移，确保密钥与代码分离存储（如使用环境变量或KMS）。",
            "status": "pending",
            "testStrategy": "直接查询数据库验证数据为乱码/密文，通过应用接口验证数据能正常解密显示，测试密钥轮换机制。",
            "parentId": "undefined"
          },
          {
            "id": 3,
            "title": "用户注销流程与数据彻底删除逻辑",
            "description": "开发用户注销功能，实现符合法规要求的物理删除或匿名化处理。",
            "dependencies": [
              2
            ],
            "details": "设计注销API接口，实现用户状态标记及关联数据（订单、记录、日志）的物理删除逻辑，增加二次确认弹窗防止误操作，生成注销完成凭证，确保数据不可恢复。",
            "status": "pending",
            "testStrategy": "执行注销操作，验证数据库中用户记录及关联数据是否被彻底清除，尝试使用注销账号登录应失败。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "隐私政策与用户协议页面上线",
            "description": "编写合规的法律文档，并在前端页面展示，集成到注册登录流程。",
            "dependencies": [
              1
            ],
            "details": "起草符合《个人信息保护法》的隐私政策和用户协议文本，开发静态H5页面，在APP/小程序内嵌入WebView展示，在注册/登录页增加“我已阅读并同意”勾选框并做强制校验。",
            "status": "pending",
            "testStrategy": "检查文案法律合规性，测试未勾选协议无法提交注册，验证页面在不同设备上的排版适配。",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "接口安全审计与防SQL注入/XSS攻击加固",
            "description": "对后端接口进行安全漏洞扫描，修复SQL注入、XSS等常见Web攻击风险。",
            "dependencies": [
              1,
              2
            ],
            "details": "部署安全扫描工具（如OWASP ZAP）进行自动化审计，修复发现的SQL注入漏洞（使用参数化查询），修复XSS漏洞（对输出进行HTML转义），配置CSP内容安全策略，实施接口签名验证和频率限制。",
            "status": "pending",
            "testStrategy": "进行渗透测试模拟攻击，验证输入特殊字符是否被过滤或转义，检查HTTP响应头是否包含安全策略。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 8,
        "recommendedSubtasks": 5,
        "expansionPrompt": "请将任务分解为：1. 全站HTTPS证书配置与传输加密实施；2. 敏感数据（如手机号）的加密存储方案；3. 用户注销流程与数据彻底删除逻辑；4. 隐私政策与用户协议页面上线；5. 接口安全审计与防SQL注入/XSS攻击加固。",
        "updatedAt": "2026-01-13T04:15:03.023Z"
      },
      {
        "id": 14,
        "title": "性能优化和测试",
        "description": "进行性能优化和全面测试,确保响应时间、并发支持等性能指标达标",
        "status": "in-progress",
        "priority": "high",
        "tags": [
          "performance",
          "testing"
        ],
        "details": "需要完成:\n1. 页面加载时间<2秒\n2. 支持1000+并发用户\n3. 多设备数据同步延迟<3秒\n4. 压力测试\n5. 兼容性测试(各平台各版本)\n6. 用户体验测试",
        "acceptanceCriteria": [
          "加载时间达标",
          "并发支持达标",
          "同步延迟达标",
          "压力测试通过",
          "兼容性测试通过",
          "用户体验良好"
        ],
        "testStrategy": "执行全面性能测试和兼容性测试",
        "subtasks": [
          {
            "id": 1,
            "title": "前端资源加载优化（代码分割与图片压缩）",
            "description": "实施前端代码分割策略及图片资源压缩，以减少初始加载时间，确保页面加载时间小于2秒。",
            "dependencies": [],
            "details": "使用Webpack或Vite配置路由懒加载和组件懒加载；对所有图片资源进行WebP格式转换及压缩；实施CDN加速策略；利用浏览器缓存机制优化静态资源加载。",
            "status": "done",
            "testStrategy": "使用Lighthouse工具进行性能评分，确保Performance分数>90，且首次内容绘制(FCP)时间达标。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T09:25:53.523Z"
          },
          {
            "id": 2,
            "title": "后端数据库查询优化与索引调整",
            "description": "优化数据库查询语句，调整索引结构，提升后端响应速度，确保支持1000+并发用户。",
            "dependencies": [],
            "details": "分析数据库慢查询日志，识别性能瓶颈；为高频查询字段添加合适的索引；优化复杂SQL查询，避免全表扫描；调整数据库连接池配置以应对高并发场景。",
            "status": "done",
            "testStrategy": "使用数据库监控工具（如MongoDB Profiler或pgBadger）验证查询响应时间，确保关键接口响应时间在预期范围内。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T09:31:59.373Z"
          },
          {
            "id": 3,
            "title": "高并发压力测试脚本编写与瓶颈分析",
            "description": "编写压力测试脚本，模拟高并发场景，执行测试并分析系统瓶颈，确保系统稳定性。",
            "dependencies": [
              1,
              2
            ],
            "details": "使用JMeter或K6编写模拟1000+并发用户的测试脚本；针对核心接口（如卜卦、登录）进行加压测试；监控服务器CPU、内存及数据库负载；记录测试数据并生成性能分析报告。",
            "status": "pending",
            "testStrategy": "在测试环境执行压力测试，持续运行至少30分钟，观察系统是否崩溃或出现严重错误，验证并发指标是否达标。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "多机型/多系统兼容性测试",
            "description": "在不同操作系统、不同设备型号上进行全面测试，确保应用在各平台各版本上运行正常。",
            "dependencies": [],
            "details": "覆盖iOS和Android主流版本（如iOS 14-17, Android 8-13）；测试不同屏幕尺寸和分辨率的适配；验证微信小程序、H5及APP端的UI一致性和功能可用性；记录并修复兼容性Bug。",
            "status": "pending",
            "testStrategy": "使用真机云测试平台（如Testin或BrowserStack）结合部分真机进行测试，确保主流机型覆盖率达到95%以上。",
            "parentId": "undefined"
          },
          {
            "id": 5,
            "title": "弱网环境下的用户体验优化",
            "description": "针对弱网络环境进行优化，提升数据同步效率和用户交互体验，确保同步延迟小于3秒。",
            "dependencies": [],
            "details": "实现本地数据缓存机制，支持离线查看；优化API请求的重试策略和超时处理；添加友好的加载状态提示和错误反馈；测试并优化在2G/3G网络下的数据传输效率。",
            "status": "pending",
            "testStrategy": "使用Charles或Fiddler工具模拟弱网环境（如300kbps），测试数据同步速度及页面加载情况，确保用户在弱网下仍能获得基本可用体验。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 8,
        "recommendedSubtasks": 5,
        "expansionPrompt": "请将任务分解为：1. 前端资源加载优化（代码分割、图片压缩）；2. 后端数据库查询优化与索引调整；3. 高并发压力测试脚本编写与瓶颈分析；4. 多机型/多系统兼容性测试；5. 弱网环境下的用户体验优化。",
        "updatedAt": "2026-01-13T09:31:59.373Z"
      },
      {
        "id": 15,
        "title": "离线功能开发",
        "description": "实现离线功能支持,包括离线起卦、离线查看已学习内容和历史记录",
        "status": "in-progress",
        "priority": "medium",
        "tags": [
          "offline",
          "ux"
        ],
        "details": "需要实现:\n1. 已学习内容离线查看\n2. 卜卦历史离线查看\n3. 离线起卦功能\n4. 解卦需联网处理\n5. 离线数据缓存管理",
        "acceptanceCriteria": [
          "离线查看学习内容正常",
          "离线查看历史正常",
          "离线起卦功能正常",
          "离线缓存管理合理",
          "联网后数据正确同步"
        ],
        "testStrategy": "测试各种离线场景,验证缓存和同步逻辑",
        "subtasks": [
          {
            "id": 1,
            "title": "本地数据库架构设计与封装",
            "description": "设计并封装本地数据库（如SQLite/Realm），为离线功能提供数据存储基础。",
            "dependencies": [],
            "details": "选择合适的本地数据库方案（SQLite或Realm），设计表结构（课程表、历史记录表、用户配置表），封装数据库操作接口（增删改查），确保线程安全和性能优化。",
            "status": "done",
            "testStrategy": "单元测试验证数据库操作的正确性，测试并发读写场景下的稳定性。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T09:15:09.363Z"
          },
          {
            "id": 2,
            "title": "关键数据离线缓存策略实现",
            "description": "实现已学习课程内容和卜卦历史记录的离线缓存逻辑。",
            "dependencies": [
              1
            ],
            "details": "定义缓存触发时机（如课程学习完成、卜卦结果生成），实现数据写入本地数据库的逻辑，设计缓存淘汰策略（如LRU），确保离线时能读取到最新已缓存的数据。",
            "status": "done",
            "testStrategy": "验证数据能否正确写入本地，断网后能否正确读取缓存数据，测试缓存更新机制。",
            "parentId": "undefined",
            "updatedAt": "2026-01-13T09:19:41.562Z"
          },
          {
            "id": 3,
            "title": "离线状态UI交互与功能降级",
            "description": "处理离线状态下的UI展示及功能限制，实现离线起卦功能。",
            "dependencies": [
              2
            ],
            "details": "监听网络状态变化，设计离线提示UI，实现离线起卦逻辑（本地生成卦象），对需要联网的功能（如解卦）进行降级处理或提示，确保用户体验流畅。",
            "status": "pending",
            "testStrategy": "模拟飞行模式或断网环境，测试UI提示是否正确，验证离线起卦功能是否可用，验证解卦时的联网提示。",
            "parentId": "undefined"
          },
          {
            "id": 4,
            "title": "联网后数据同步与一致性更新",
            "description": "实现设备重新联网后，本地数据与服务器的同步及一致性维护。",
            "dependencies": [
              3
            ],
            "details": "设计数据同步协议，处理离线期间产生的本地变更（如新的卜卦记录），解决数据冲突（如同一记录在两端被修改），实现增量同步机制，确保最终一致性。",
            "status": "pending",
            "testStrategy": "模拟离线操作后恢复网络，验证数据是否自动同步，测试数据冲突场景下的处理逻辑，验证同步后的数据一致性。",
            "parentId": "undefined"
          }
        ],
        "dependencies": [],
        "complexity": 7,
        "recommendedSubtasks": 4,
        "expansionPrompt": "请将任务分解为：1. 本地数据库（如SQLite/Realm）架构设计与封装；2. 关键数据（课程、历史）的离线缓存策略；3. 离线状态下的UI交互与功能降级处理；4. 联网后的数据同步与一致性更新机制。",
        "updatedAt": "2026-01-13T09:19:41.562Z"
      },
      {
        "id": 16,
        "title": "本地开发环境搭建：Redis与MongoDB配置",
        "description": "使用 Docker Compose 安装并配置 Redis 和 MongoDB，建立本地开发环境以支持 API 接口的手工测试与调试。",
        "details": "需要完成以下配置工作：\n1. **Docker Compose 配置**：创建 `docker-compose.yml` 文件，定义 `redis` 和 `mongodb` 两个服务。\n2. **Redis 服务配置**：使用官方镜像（如 redis:7-alpine），映射默认端口 6379，配置 AOF 持久化策略，并通过环境变量设置访问密码以确保安全。\n3. **MongoDB 服务配置**：使用官方镜像（如 mongo:6），映射默认端口 27017，挂载数据卷以实现数据持久化，配置初始化管理员用户和认证机制（使用 MONGO_INITDB_ROOT_USERNAME 和 MONGO_INITDB_ROOT_PASSWORD）。\n4. **网络与卷管理**：定义独立的 Docker 网络和数据卷，确保服务间隔离及数据安全存储。\n5. **环境变量管理**：创建 `.env` 示例文件，包含端口、密码、数据路径等可配置项，避免硬编码。\n6. **启动文档**：编写 `README.md` 或 `SETUP.md`，详细说明 Docker 环境要求、启动命令（`docker-compose up -d`）、停止命令（`docker-compose down`）、查看日志命令以及连接字符串示例。",
        "testStrategy": "1. 执行 `docker-compose up -d` 启动服务，使用 `docker ps` 确认容器状态为 'Up' 且无重启记录。\n2. 使用 Redis 客户端（如 redis-cli 或 Another Redis Desktop Manager）连接本地 Redis，执行 `PING` 和 `SET/GET` 操作验证连通性。\n3. 使用 MongoDB 客户端（如 mongosh 或 MongoDB Compass）连接本地 MongoDB，验证认证登录成功，并能创建/读取测试集合。\n4. 重启 Docker 容器，验证之前写入的测试数据是否通过数据卷成功持久化。\n5. 确认 API 后端服务能够使用配置文件中的连接字符串成功连接到这两个数据库实例。",
        "status": "done",
        "dependencies": [
          "3"
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "编写Docker Compose配置、环境变量及文档并验证服务",
            "description": "创建包含Redis和MongoDB服务的docker-compose.yml文件，配置环境变量和启动文档，并验证服务的连通性、持久化及安全性。",
            "dependencies": [],
            "details": "1. 创建 docker-compose.yml：定义 redis (redis:7-alpine, 端口6379, AOF持久化, 密码) 和 mongodb (mongo:6, 端口27017, 数据卷, 认证) 服务。\n2. 配置网络与卷：确保服务隔离及数据持久化。\n3. 创建 .env 文件：管理端口、密码等配置。\n4. 编写 SETUP.md：包含环境要求、启动/停止命令及连接字符串。\n5. 验证服务：启动容器，使用客户端连接测试读写，重启容器验证数据持久化。",
            "status": "pending",
            "testStrategy": "1. 执行 docker-compose up -d，使用 docker ps 确认容器运行正常。\n2. 使用 Redis 客户端连接并执行 PING/SET/GET 操作。\n3. 使用 MongoDB 客户端连接并验证认证及集合操作。\n4. 重启容器，验证数据是否持久化保存。",
            "parentId": "undefined"
          }
        ],
        "complexity": 3,
        "recommendedSubtasks": 1,
        "expansionPrompt": "创建一个子任务：编写Docker Compose配置文件（包含Redis和MongoDB服务）、环境变量文件以及启动文档，并验证服务的连通性、持久化及安全性配置。",
        "updatedAt": "2026-01-13T00:17:04.152Z"
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2026-01-13T13:25:26.971Z",
      "taskCount": 16,
      "completedCount": 10,
      "tags": [
        "master"
      ],
      "created": "2026-01-13T23:56:35.942Z",
      "description": "Tasks for master context"
    }
  }
}